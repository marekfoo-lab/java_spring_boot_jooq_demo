databaseChangeLog:
  # ACCOUNT: ManyToMany ROLE, OneToMany ADDRESS, OneToOne ?
  - changeSet:
      id: 092524-01
      author: marekfoo-lab
      changes:
        - createSequence:
            sequenceName: ACCOUNT_ID_SEQ
            startValue: 1
            incrementBy: 1
        - createTable:
            tableName: ACCOUNT
            columns:
              - column:
                  name: ID
                  type: INT
                  constraints:
                    primaryKey: true
                  defaultValueComputed: "nextval('ACCOUNT_ID_SEQ')"
              - column:
                  name: LOGIN
                  type: VARCHAR(30)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: FIRST_NAME
                  type: VARCHAR(50)
              - column:
                  name: LAST_NAME
                  type: VARCHAR(70)
              - column:
                  name: PASSWORD
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: EMAIL
                  type: VARCHAR(60)
                  constraints:
                    nullable: false
                    unique: true

  # ADDRESS: ManyToOne USER
  - changeSet:
      id: 092524-03
      author: marekfoo-lab
      changes:
        - createSequence:
            sequenceName: ADDRESS_ID_SEQ
            startValue: 1
            incrementBy: 1
        - createTable:
            tableName: ADDRESS
            columns:
              - column:
                  name: ID
                  type: INT
                  constraints:
                    primaryKey: true
                    nullable: false
                  defaultValueComputed: "nextval('ADDRESS_ID_SEQ')"
              - column:
                  name: STREET
                  type: VARCHAR(70)
                  constraints:
                    nullable: false
              - column:
                  name: ZIP_CODE
                  type: VARCHAR(10)
              - column:
                  name: CITY
                  type: VARCHAR(70)
              - column:
                  name: ADDRESS_TYPE
                  type: VARCHAR(20)
                  constraints:
                    nullable: false
              - column:
                  name: ACCOUNT_ID
                  type: INT
                  constraints:
                    nullable: false

  # FK for ADDRESS -> ACCOUNT
  - changeSet:
      id: 092524-05
      author: marekfoo-lab
      changes:
        - addForeignKeyConstraint:
            baseTableName: ADDRESS
            baseColumnNames: ACCOUNT_ID
            referencedTableName: ACCOUNT
            referencedColumnNames: ID
            constraintName: FK_ADDRESS_ACCOUNT

  # Unique ADDRESS TYPE
  - changeSet:
      id: 092524-06
      author: marekfoo-lab
      changes:
        - addUniqueConstraint:
            tableName: ADDRESS
            columnNames: ACCOUNT_ID, ADDRESS_TYPE
            constraintName: UQ_ADDRESS_TYPE_ACCOUNT

  # ROLE: ManyToMany User
  - changeSet:
      id: 092524-07
      author: marekfoo-lab
      changes:
        - createSequence:
            sequenceName: ROLE_ID_SEQ
            startValue: 1
            incrementBy: 1
        - createTable:
            tableName: ROLE
            columns:
              - column:
                  name: ID
                  type: INT
                  constraints:
                    primaryKey: true
                    nullable: false
                  defaultValueComputed: "nextval('ROLE_ID_SEQ')"
              - column:
                  name: NAME
                  type: VARCHAR(30)
                  constraints:
                    nullable: false
                    unique: true

  # ROLE_ACCOUNT
  - changeSet:
      id: 092524-08
      author: marekfoo-lab
      changes:
        - createTable:
            tableName: ROLE_ACCOUNT
            columns:
              - column:
                  name: ROLE_ID
                  type: INT
                  constraints:
                    nullable: false
              - column:
                  name: ACCOUNT_ID
                  type: INT
                  constraints:
                    nullable: false

  # PK: ROLE_ACCOUNT
  - changeSet:
      id: 092524-09
      author: marekfoo-lab
      changes:
        - addPrimaryKey:
            columnNames: ROLE_ID, ACCOUNT_ID
            constraintName: PK_ROLE_ACCOUNT
            tableName: ROLE_ACCOUNT

  # FK: ROLE_ACCOUNT -> ROLE
  - changeSet:
      id: 092524-10
      author: marekfoo-lab
      changes:
        - addForeignKeyConstraint:
            baseTableName: ROLE_ACCOUNT
            baseColumnNames: ROLE_ID
            referencedTableName: ROLE
            referencedColumnNames: ID
            constraintName: FK_ROLE_ACCOUNT_ROLE

  # LOGIN_HISTORY: ManyToOne USER
  - changeSet:
      id: 092524-11
      author: marekfoo-lab
      changes:
        - createSequence:
            sequenceName: LOGIN_HISTORY_ID_SEQ
            startValue: 1
            incrementBy: 1
        - createTable:
            tableName: LOGIN_HISTORY
            columns:
              - column:
                  name: ID
                  type: INT
                  constraints:
                    primaryKey: true
                    nullable: false
                  defaultValueComputed: "nextval('LOGIN_HISTORY_ID_SEQ')"
              - column:
                  name: ACCOUNT_ID
                  type: INT
                  constraints:
                    nullable: false
              - column:
                  name: LAST_LOGIN
                  type: TIMESTAMP
                  constraints:
                    nullable: false
              - column:
                  name: IP_ADDRESS
                  type: VARCHAR(39)
                  constraints:
                    nullable: true
              - column:
                  name: IS_SUCCESS
                  type: VARCHAR(1)
                  constraints:
                    nullable: false

  # FK: LOGIN_HISTORY -> ACCOUNT
  - changeSet:
      id: 092524-12
      author: marekfoo-lab
      changes:
        - addForeignKeyConstraint:
            baseTableName: LOGIN_HISTORY
            baseColumnNames: ACCOUNT_ID
            referencedTableName: ACCOUNT
            referencedColumnNames: ID
            constraintName: FK_LOGIN_HISTORY_ACCOUNT